'use strict'





/******************************************************************************\
  Module imports
\******************************************************************************/

let compress = require('koa-compress')
let koa = require('koa')
let logger = require('koa-logger')
let route = require('koa-route')





/******************************************************************************\
  Route controllers
\******************************************************************************/

let inventory = require('./controllers/inventory')





/******************************************************************************\
  Initialize the app
\******************************************************************************/
let app = koa()





/******************************************************************************\
  Pre route middleware
\******************************************************************************/

// Error handling

app.use(function * errorHandler (next) {
  try {
    yield next

  } catch (error) {
    this.status = error.status || 500
    this.body = error.message
    this.app.emit('error', error, this)
  }
})

app.use(logger())





/******************************************************************************\
  Routes
\******************************************************************************/

app.use(route.get('/inventory/pokemon', inventory.pokemon))
app.use(route.get('/inventory/items', inventory.items))





/******************************************************************************\
  Post route middleware
\******************************************************************************/

app.use(compress())





/******************************************************************************\
  Start the app
\******************************************************************************/

app.listen(3000)
